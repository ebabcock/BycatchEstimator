<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="#' Generate standard errors and confidence intervals of predictions from simulation from regression coefficients and their var/covar matrix
#'
#' @param modfit1 Value
#' @param modfit2 Value
#' @param newdat Value
#' @param modtype Value
#' @param obsdatval Value
#' @param includeObsCatch Value
#' @param nsim Value
#' @param requiredVarNames Value
#' @param CIval Value
#' @param printOutput Value
#' @param catchType Value
#' @param common Value
#' @param dirname Value
#' @param run Value
#' @import tidyr
#' @importFrom stats predict model.matrix rbinom sigma rnorm rlnorm rnbinom quantile
#' @importFrom MASS mvrnorm gamma.shape
#' @keywords internal
makePredictionsSimVar&amp;lt;-function(modfit1, modfit2=NULL, modtype, newdat, obsdatval=NULL, includeObsCatch, nsim, requiredVarNames, CIval, printOutput=TRUE, catchType, common, dirname, run) 
#Separate out sample units
if(includeObsCatch)    newdat$Effort=newdat$unsampledEffort/newdat$SampleUnits else
newdat$Effort=newdat$Effort/newdat$SampleUnits
newdat=uncount(newdat,.data$SampleUnits)
nObs=dim(newdat)1
#Get predictions
if(modtype==&quot;Tweedie&quot;)  response1&amp;lt;-data.frame(cplm::predict(modfit1,newdata=newdat,type=&quot;response&quot;,se.fit=TRUE)) else
response1&amp;lt;-data.frame(predict(modfit1,newdata=newdat,type=&quot;response&quot;,se.fit=TRUE))
if(dim(response1)2==1) 
names(response1)=&quot;fit&quot;
if(modtype==&quot;Tweedie&quot;)
response1$se.fit=getSimSE(modfit1, newdat, transFunc=&quot;exp&quot;,offsetval=NULL, nsim=nsim) else
response1$se.fit=rep(NA,dim(response1)2)if(!is.null(modfit2))  
response2&amp;lt;-data.frame(predict(modfit2,newdata=newdat,se.fit=TRUE,type=&quot;response&quot;))
names(response2)=paste0(names(response2),&quot;2&quot;)if(!any(is.na(response1$se.fit)) &amp;amp; !max(response1$se.fit/response1$fit,na.rm=TRUE)&amp;gt;10000)  
#Set up model matrices for simulation
yvar=sub( &quot; &quot;, &quot; &quot;,formula(modfit1) )2
newdat&amp;lt;-cbind(y=rep(1,nObs),newdat)
names(newdat)1=yvar
a=model.matrix(formula(modfit1),data=newdat)
if(!is.null(modfit2)) 
yvar=sub( &quot; &quot;, &quot; &quot;,formula(modfit2) )2
if(! yvar %in% names(newdat)) 
newdat&amp;lt;-cbind(y=rep(1,nObs),newdat)
names(newdat)1=yvarb=model.matrix(formula(modfit2),data=newdat)#Get predictions sim
if(modtype == &quot;Binomial&quot;) 
allpred&amp;lt;-cbind(newdat,response1) %&amp;gt;%
mutate(Total=.data$fit,TotalVar=.data$se.fit^2+.data$fit*(1-.data$fit))
sim=replicate(nsim,rbinom(nObs,1,ilogit(a %% mvrnorm(1,coef(modfit1),vcov(modfit1))) ) )

if(modtype==&quot;Normal&quot;) 
allpred&amp;lt;-cbind(newdat,response1)   %&amp;gt;%
mutate(Total=.data$Effort.data$fit,
TotalVar=.data$Effort^2*(.data$se.fit^2+sigma(.data$modfit1)^2))
sim=replicate(nsim,rnorm(nObs,
mean=as.vector(a %% mvrnorm(1,coef(modfit1),vcov(modfit1))),
sd=sigma(modfit1)))newdat$Effort

if(modtype==&quot;Lognormal&quot;) 
allpred&amp;lt;-cbind(newdat,response1)   %&amp;gt;%
mutate(Total=.data$Effort(lnorm.mean(.data$fit,sqrt(.data$se.fit^2+sigma(modfit1)^2))-0.1),
TotalVar=.data$Effort^2lnorm.se(.data$fit,sqrt(.data$se.fit^2+sigma(modfit1)^2))^2)
sim=replicate(nsim,rlnorm(nObs,
meanlog=as.vector((a %% mvrnorm(1,coef(modfit1),vcov(modfit1)))),
sdlog=sigma(modfit1))-0.1)newdat$Effort

if(modtype==&quot;Gamma&quot;) 
allpred&amp;lt;-cbind(newdat,response1)   %&amp;gt;%
mutate(Total=.data$Effort(.data$fit-0.1),
TotalVar=.data$Effort^2(.data$se.fit^2+.data$fitgamma.shape(modfit1)[1]))
sim=replicate(nsim,newdat$Effort(simulateGammaDraw(modfit1,nObs,a)-0.1) )if(modtype == &quot;Delta-Lognormal&quot;) 
allpred&amp;lt;-cbind(newdat,response1,response2) %&amp;gt;%
mutate(pos.cpue=lnorm.mean(.data$fit2,sqrt(.data$se.fit2^2+sigma(modfit2)^2)),
pos.cpue.se=lnorm.se(.data$fit2,sqrt(.data$se.fit2^2+sigma(modfit2)^2)),
prob.se=sqrt(.data$se.fit^2+.data$fit*(1-.data$fit))) %&amp;gt;%
mutate(Total=.data$Effort*.data$fit*.data$pos.cpue,
TotalVar=.data$Effort^2lo.se(.data$fit,.data$prob.se,.data$pos.cpue,.data$pos.cpue.se)^2)
sim1=replicate(nsim,rbinom(nObs,1,ilogit(a %% mvrnorm(1,coef(modfit1),vcov(modfit1))) ) )
sim2=replicate(nsim,newdat$Effortexp(rnorm(nObs,b %%
mvrnorm(1,coef(modfit2),vcov(modfit2)),sigma(modfit2)) ) )
sim=sim1sim2

if(modtype == &quot;Delta-Gamma&quot;) 
allpred&amp;lt;-cbind(newdat,response1,response2) %&amp;gt;%
mutate(pos.cpue.se=sqrt(.data$se.fit2^2+.data$fit2gamma.shape(modfit2)[1]),
prob.se=sqrt(.data$se.fit^2+.data$fit*(1-.data$fit))) %&amp;gt;%
mutate(Total=.data$Effort*.data$fit*.data$fit2,
TotalVar=.data$Effort^2lo.se(.data$fit,.data$prob.se,.data$fit2,.data$pos.cpue.se)^2)
sim1=replicate(nsim,rbinom(nObs,1,ilogit(a %% mvrnorm(1,coef(modfit1),vcov(modfit1))) ) )
sim2=replicate(nsim,newdat$EffortsimulateGammaDraw(modfit2,nObs,b) )
sim=sim1sim2if(modtype==&quot;NegBin&quot;) 
allpred&amp;lt;-cbind(newdat,response1)   %&amp;gt;%
mutate(Total=.data$fit,TotalVar=.data$se.fit^2+.data$fit+.data$fit^2/modfit1$theta)
sim = replicate(nsim,rnbinom(nObs,mu=exp(a %% mvrnorm(1,coef(modfit1),vcov(modfit1)))newdat$Effort,
size=modfit1$theta))  #Simulate negative binomial data

if(modtype==&quot;Tweedie&quot;) 
allpred=cbind(newdat,response1)   %&amp;gt;%
mutate(Total=.data$Effort.data$fit,
TotalVar=.data$Effort^2(.data$se.fit^2+modfit1$phi*.data$fit^modfit1$p))
sim=replicate(nsim,rtweedie(nObs,power=modfit1$p,
mu=as.vector(exp(a %% mvrnorm(1,coef(modfit1),modfit1$vcov))),
phi=modfit1$phi))newdat$Effort

if(modtype==&quot;TMBnbinom1&quot;) 
allpred&amp;lt;-cbind(newdat,response1)  %&amp;gt;%
mutate(Total=.data$fit,
TotalVar=.data$se.fit^2+.data$fit+.data$fitsigma(modfit1))
sim = replicate(nsim,simulateNegBin1Draw(modfit1,nObs,a,newdat$Effort))

if(modtype==&quot;TMBnbinom2&quot;) 
allpred&amp;lt;-cbind(newdat,response1)  %&amp;gt;%
mutate(Total=.data$fit,
TotalVar=.data$se.fit^2+.data$fit+.data$fit^2/sigma(modfit1))
sim = replicate(nsim,rnbinom(nObs,mu=exp(a %% mvrnorm(1,fixef(modfit1)[1],
vcov(modfit1)[1]))newdat$Effort, size=sigma(modfit1)))

if(modtype==&quot;TMBtweedie&quot;) 
allpred&amp;lt;-cbind(newdat,response1)  %&amp;gt;%
mutate(Total=.data$Effort.data$fit,
TotalVar=.data$Effort^2*(.data$se.fit^2+sigma(modfit1)*.data$fit^(glmmTMB:::.tweedie_power(modfit1))))
sim=replicate(nsim, simulateTMBTweedieDraw(modfit1,nObs,a,newdat$Effort) )if(includeObsCatch &amp;amp; modtype!=&quot;Binomial&quot;) 
d=match(allpred$matchColumn,obsdatval$matchColumn)
allpred$Total!is.na(d)= allpred$Total!is.na(d) + obsdatval$Catch[d!is.na(d)]
sim!is.na(d),= sim!is.na(d), + obsdatval$Catch[d!is.na(d)]if(includeObsCatch &amp;amp; modtype==&quot;Binomial&quot;) 
d=match(allpred$matchColumn,obsdatval$matchColumn)
allpred$Total!is.na(d)= obsdatval$pres[d!is.na(d)]
sim!is.na(d),= obsdatval$presd!is.na(d)stratatotal&amp;lt;-allpred %&amp;gt;%
group_by_at(all_of(requiredVarNames)) %&amp;gt;%
summarize(Total=sum(.data$Total,na.rm=TRUE))
yeartotal&amp;lt;-allpred%&amp;gt;% group_by(.data$Year) %&amp;gt;%
summarize(Total=sum(.data$Total,na.rm=TRUE))
stratapred&amp;lt;-cbind(newdat,sim) %&amp;gt;%
group_by_at(all_of(requiredVarNames)) %&amp;gt;%
summarize_at(.vars=as.character(1:nsim),.funs=sum,na.rm=TRUE) %&amp;gt;%
rowwise() %&amp;gt;%
mutate(Total.mean=mean(c_across(as.character(1:nsim))),
TotalVar=var(c_across(as.character(1:nsim))),
TotalLCI=quantile(c_across(as.character(1:nsim)),p=CIval/2),
TotalUCI=quantile(c_across(as.character(1:nsim)),p=1-CIval/2)) %&amp;gt;%
mutate(TotalLCI=ifelse(.data$TotalLCI&amp;lt;0,0,.data$TotalLCI),Total.mean=ifelse(.data$Total.mean&amp;lt;0,0,.data$Total.mean)) %&amp;gt;%
mutate(Total.se=sqrt(.data$TotalVar))  %&amp;gt;%
mutate(Total.cv=.data$Total.se/.data$Total.mean)  %&amp;gt;%
dplyr::select(-one_of(as.character(1:nsim)))
stratapred$Total=stratatotal$Total
yearpred&amp;lt;-cbind(newdat,sim) %&amp;gt;%
group_by(.data$Year) %&amp;gt;%
summarize_at(.vars=as.character(1:nsim),.funs=sum,na.rm=TRUE) %&amp;gt;%
rowwise() %&amp;gt;%
mutate(Total.mean=mean(c_across(as.character(1:nsim))),
TotalVar=var(c_across(as.character(1:nsim))),
TotalLCI=quantile(c_across(as.character(1:nsim)),p=CIval/2),
TotalUCI=quantile(c_across(as.character(1:nsim)),p=1-CIval/2)) %&amp;gt;%
mutate(TotalLCI=ifelse(.data$TotalLCI&amp;lt;0,0,.data$TotalLCI),Total.mean=ifelse(.data$Total.mean&amp;lt;0,0,.data$Total.mean)) %&amp;gt;%
mutate(Total.se=sqrt(.data$TotalVar))  %&amp;gt;%
mutate(Total.cv=.data$Total.se/.data$Total.mean)  %&amp;gt;%
dplyr::select(-one_of(as.character(1:nsim)))
yearpred$Total&amp;lt;-yeartotal$Total
if(is.na(max(yearpred$Total.cv)) | max(yearpred$Total.cv,na.rm=TRUE)&amp;gt;10) 
print(paste(commonrun,modtype,&quot; CV &amp;gt;10 or NA variance&quot;))
returnval=NULL
  else       returnval=yearpred  
if(printOutput) 
write.csv(stratapred,paste0(dirname[run],commonrun,catchTyperun,modtype,&quot;StratumSummary.csv&quot;))
write.csv(yearpred,paste0(dirname[run],commonrun,catchTyperun,modtype,&quot;AnnualSummary.csv&quot;)) else  
print(paste(commonrun,modtype,&quot; CV &amp;gt;10 or NA variance&quot;))
returnval=NULLreturnval

Generate predictions without estimating variance"><title>#' Generate standard errors and confidence intervals of predictions from simulation from regression coefficients and their var/covar matrix
#'
#' @param modfit1 Value
#' @param modfit2 Value
#' @param newdat Value
#' @param modtype Value
#' @param obsdatval Value
#' @param includeObsCatch Value
#' @param nsim Value
#' @param requiredVarNames Value
#' @param CIval Value
#' @param printOutput Value
#' @param catchType Value
#' @param common Value
#' @param dirname Value
#' @param run Value
#' @import tidyr
#' @importFrom stats predict model.matrix rbinom sigma rnorm rlnorm rnbinom quantile
#' @importFrom MASS mvrnorm gamma.shape
#' @keywords internal
makePredictionsSimVar&lt;-function(modfit1, modfit2=NULL, modtype, newdat, obsdatval=NULL, includeObsCatch, nsim, requiredVarNames, CIval, printOutput=TRUE, catchType, common, dirname, run) 
#Separate out sample units
if(includeObsCatch)    newdat$Effort=newdat$unsampledEffort/newdat$SampleUnits else
newdat$Effort=newdat$Effort/newdat$SampleUnits
newdat=uncount(newdat,.data$SampleUnits)
nObs=dim(newdat)1
#Get predictions
if(modtype=="Tweedie")  response1&lt;-data.frame(cplm::predict(modfit1,newdata=newdat,type="response",se.fit=TRUE)) else
response1&lt;-data.frame(predict(modfit1,newdata=newdat,type="response",se.fit=TRUE))
if(dim(response1)2==1) 
names(response1)="fit"
if(modtype=="Tweedie")
response1$se.fit=getSimSE(modfit1, newdat, transFunc="exp",offsetval=NULL, nsim=nsim) else
response1$se.fit=rep(NA,dim(response1)2)

if(!is.null(modfit2))  
response2&lt;-data.frame(predict(modfit2,newdata=newdat,se.fit=TRUE,type="response"))
names(response2)=paste0(names(response2),"2")

if(!any(is.na(response1$se.fit)) &amp; !max(response1$se.fit/response1$fit,na.rm=TRUE)&gt;10000)  
#Set up model matrices for simulation
yvar=sub( " ", " ",formula(modfit1) )2
newdat&lt;-cbind(y=rep(1,nObs),newdat)
names(newdat)1=yvar
a=model.matrix(formula(modfit1),data=newdat)
if(!is.null(modfit2)) 
yvar=sub( " ", " ",formula(modfit2) )2
if(! yvar %in% names(newdat)) 
newdat&lt;-cbind(y=rep(1,nObs),newdat)
names(newdat)1=yvar

b=model.matrix(formula(modfit2),data=newdat)

#Get predictions sim
if(modtype == "Binomial") 
allpred&lt;-cbind(newdat,response1) %&gt;%
mutate(Total=.data$fit,TotalVar=.data$se.fit^2+.data$fit*(1-.data$fit))
sim=replicate(nsim,rbinom(nObs,1,ilogit(a %% mvrnorm(1,coef(modfit1),vcov(modfit1))) ) )

if(modtype=="Normal") 
allpred&lt;-cbind(newdat,response1)   %&gt;%
mutate(Total=.data$Effort.data$fit,
TotalVar=.data$Effort^2*(.data$se.fit^2+sigma(.data$modfit1)^2))
sim=replicate(nsim,rnorm(nObs,
mean=as.vector(a %% mvrnorm(1,coef(modfit1),vcov(modfit1))),
sd=sigma(modfit1)))newdat$Effort

if(modtype=="Lognormal") 
allpred&lt;-cbind(newdat,response1)   %&gt;%
mutate(Total=.data$Effort(lnorm.mean(.data$fit,sqrt(.data$se.fit^2+sigma(modfit1)^2))-0.1),
TotalVar=.data$Effort^2lnorm.se(.data$fit,sqrt(.data$se.fit^2+sigma(modfit1)^2))^2)
sim=replicate(nsim,rlnorm(nObs,
meanlog=as.vector((a %% mvrnorm(1,coef(modfit1),vcov(modfit1)))),
sdlog=sigma(modfit1))-0.1)newdat$Effort

if(modtype=="Gamma") 
allpred&lt;-cbind(newdat,response1)   %&gt;%
mutate(Total=.data$Effort(.data$fit-0.1),
TotalVar=.data$Effort^2(.data$se.fit^2+.data$fitgamma.shape(modfit1)[1]))
sim=replicate(nsim,newdat$Effort(simulateGammaDraw(modfit1,nObs,a)-0.1) )

if(modtype == "Delta-Lognormal") 
allpred&lt;-cbind(newdat,response1,response2) %&gt;%
mutate(pos.cpue=lnorm.mean(.data$fit2,sqrt(.data$se.fit2^2+sigma(modfit2)^2)),
pos.cpue.se=lnorm.se(.data$fit2,sqrt(.data$se.fit2^2+sigma(modfit2)^2)),
prob.se=sqrt(.data$se.fit^2+.data$fit*(1-.data$fit))) %&gt;%
mutate(Total=.data$Effort*.data$fit*.data$pos.cpue,
TotalVar=.data$Effort^2lo.se(.data$fit,.data$prob.se,.data$pos.cpue,.data$pos.cpue.se)^2)
sim1=replicate(nsim,rbinom(nObs,1,ilogit(a %% mvrnorm(1,coef(modfit1),vcov(modfit1))) ) )
sim2=replicate(nsim,newdat$Effortexp(rnorm(nObs,b %%
mvrnorm(1,coef(modfit2),vcov(modfit2)),sigma(modfit2)) ) )
sim=sim1sim2

if(modtype == "Delta-Gamma") 
allpred&lt;-cbind(newdat,response1,response2) %&gt;%
mutate(pos.cpue.se=sqrt(.data$se.fit2^2+.data$fit2gamma.shape(modfit2)[1]),
prob.se=sqrt(.data$se.fit^2+.data$fit*(1-.data$fit))) %&gt;%
mutate(Total=.data$Effort*.data$fit*.data$fit2,
TotalVar=.data$Effort^2lo.se(.data$fit,.data$prob.se,.data$fit2,.data$pos.cpue.se)^2)
sim1=replicate(nsim,rbinom(nObs,1,ilogit(a %% mvrnorm(1,coef(modfit1),vcov(modfit1))) ) )
sim2=replicate(nsim,newdat$EffortsimulateGammaDraw(modfit2,nObs,b) )
sim=sim1sim2

if(modtype=="NegBin") 
allpred&lt;-cbind(newdat,response1)   %&gt;%
mutate(Total=.data$fit,TotalVar=.data$se.fit^2+.data$fit+.data$fit^2/modfit1$theta)
sim = replicate(nsim,rnbinom(nObs,mu=exp(a %% mvrnorm(1,coef(modfit1),vcov(modfit1)))newdat$Effort,
size=modfit1$theta))  #Simulate negative binomial data

if(modtype=="Tweedie") 
allpred=cbind(newdat,response1)   %&gt;%
mutate(Total=.data$Effort.data$fit,
TotalVar=.data$Effort^2(.data$se.fit^2+modfit1$phi*.data$fit^modfit1$p))
sim=replicate(nsim,rtweedie(nObs,power=modfit1$p,
mu=as.vector(exp(a %% mvrnorm(1,coef(modfit1),modfit1$vcov))),
phi=modfit1$phi))newdat$Effort

if(modtype=="TMBnbinom1") 
allpred&lt;-cbind(newdat,response1)  %&gt;%
mutate(Total=.data$fit,
TotalVar=.data$se.fit^2+.data$fit+.data$fitsigma(modfit1))
sim = replicate(nsim,simulateNegBin1Draw(modfit1,nObs,a,newdat$Effort))

if(modtype=="TMBnbinom2") 
allpred&lt;-cbind(newdat,response1)  %&gt;%
mutate(Total=.data$fit,
TotalVar=.data$se.fit^2+.data$fit+.data$fit^2/sigma(modfit1))
sim = replicate(nsim,rnbinom(nObs,mu=exp(a %% mvrnorm(1,fixef(modfit1)[1],
vcov(modfit1)[1]))newdat$Effort, size=sigma(modfit1)))

if(modtype=="TMBtweedie") 
allpred&lt;-cbind(newdat,response1)  %&gt;%
mutate(Total=.data$Effort.data$fit,
TotalVar=.data$Effort^2*(.data$se.fit^2+sigma(modfit1)*.data$fit^(glmmTMB:::.tweedie_power(modfit1))))
sim=replicate(nsim, simulateTMBTweedieDraw(modfit1,nObs,a,newdat$Effort) )

if(includeObsCatch &amp; modtype!="Binomial") 
d=match(allpred$matchColumn,obsdatval$matchColumn)
allpred$Total!is.na(d)= allpred$Total!is.na(d) + obsdatval$Catch[d!is.na(d)]
sim!is.na(d),= sim!is.na(d), + obsdatval$Catch[d!is.na(d)]

if(includeObsCatch &amp; modtype=="Binomial") 
d=match(allpred$matchColumn,obsdatval$matchColumn)
allpred$Total!is.na(d)= obsdatval$pres[d!is.na(d)]
sim!is.na(d),= obsdatval$presd!is.na(d)

stratatotal&lt;-allpred %&gt;%
group_by_at(all_of(requiredVarNames)) %&gt;%
summarize(Total=sum(.data$Total,na.rm=TRUE))
yeartotal&lt;-allpred%&gt;% group_by(.data$Year) %&gt;%
summarize(Total=sum(.data$Total,na.rm=TRUE))
stratapred&lt;-cbind(newdat,sim) %&gt;%
group_by_at(all_of(requiredVarNames)) %&gt;%
summarize_at(.vars=as.character(1:nsim),.funs=sum,na.rm=TRUE) %&gt;%
rowwise() %&gt;%
mutate(Total.mean=mean(c_across(as.character(1:nsim))),
TotalVar=var(c_across(as.character(1:nsim))),
TotalLCI=quantile(c_across(as.character(1:nsim)),p=CIval/2),
TotalUCI=quantile(c_across(as.character(1:nsim)),p=1-CIval/2)) %&gt;%
mutate(TotalLCI=ifelse(.data$TotalLCI&lt;0,0,.data$TotalLCI),Total.mean=ifelse(.data$Total.mean&lt;0,0,.data$Total.mean)) %&gt;%
mutate(Total.se=sqrt(.data$TotalVar))  %&gt;%
mutate(Total.cv=.data$Total.se/.data$Total.mean)  %&gt;%
dplyr::select(-one_of(as.character(1:nsim)))
stratapred$Total=stratatotal$Total
yearpred&lt;-cbind(newdat,sim) %&gt;%
group_by(.data$Year) %&gt;%
summarize_at(.vars=as.character(1:nsim),.funs=sum,na.rm=TRUE) %&gt;%
rowwise() %&gt;%
mutate(Total.mean=mean(c_across(as.character(1:nsim))),
TotalVar=var(c_across(as.character(1:nsim))),
TotalLCI=quantile(c_across(as.character(1:nsim)),p=CIval/2),
TotalUCI=quantile(c_across(as.character(1:nsim)),p=1-CIval/2)) %&gt;%
mutate(TotalLCI=ifelse(.data$TotalLCI&lt;0,0,.data$TotalLCI),Total.mean=ifelse(.data$Total.mean&lt;0,0,.data$Total.mean)) %&gt;%
mutate(Total.se=sqrt(.data$TotalVar))  %&gt;%
mutate(Total.cv=.data$Total.se/.data$Total.mean)  %&gt;%
dplyr::select(-one_of(as.character(1:nsim)))
yearpred$Total&lt;-yeartotal$Total
if(is.na(max(yearpred$Total.cv)) | max(yearpred$Total.cv,na.rm=TRUE)&gt;10) 
print(paste(commonrun,modtype," CV &gt;10 or NA variance"))
returnval=NULL
  else       returnval=yearpred  
if(printOutput) 
write.csv(stratapred,paste0(dirname[run],commonrun,catchTyperun,modtype,"StratumSummary.csv"))
write.csv(yearpred,paste0(dirname[run],commonrun,catchTyperun,modtype,"AnnualSummary.csv"))

 else  
print(paste(commonrun,modtype," CV &gt;10 or NA variance"))
returnval=NULL

returnval

Generate predictions without estimating variance — makePredictionsNoVar • BycatchEstimator</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="#' Generate standard errors and confidence intervals of predictions from simulation from regression coefficients and their var/covar matrix
#'
#' @param modfit1 Value
#' @param modfit2 Value
#' @param newdat Value
#' @param modtype Value
#' @param obsdatval Value
#' @param includeObsCatch Value
#' @param nsim Value
#' @param requiredVarNames Value
#' @param CIval Value
#' @param printOutput Value
#' @param catchType Value
#' @param common Value
#' @param dirname Value
#' @param run Value
#' @import tidyr
#' @importFrom stats predict model.matrix rbinom sigma rnorm rlnorm rnbinom quantile
#' @importFrom MASS mvrnorm gamma.shape
#' @keywords internal
makePredictionsSimVar&lt;-function(modfit1, modfit2=NULL, modtype, newdat, obsdatval=NULL, includeObsCatch, nsim, requiredVarNames, CIval, printOutput=TRUE, catchType, common, dirname, run) 
#Separate out sample units
if(includeObsCatch)    newdat$Effort=newdat$unsampledEffort/newdat$SampleUnits else
newdat$Effort=newdat$Effort/newdat$SampleUnits
newdat=uncount(newdat,.data$SampleUnits)
nObs=dim(newdat)1
#Get predictions
if(modtype==" tweedie response1 else if names newdat transfunc="exp" nsim="nsim)" response2 up model matrices for simulation yvar="sub(" a="model.matrix(formula(modfit1),data=newdat)" b="model.matrix(formula(modfit2),data=newdat)" predictions sim allpred mutate mvrnorm totalvar=".data$Effort^2*(.data$se.fit^2+sigma(.data$modfit1)^2))" mean="as.vector(a" sd="sigma(modfit1)))newdat$Effort" meanlog="as.vector((a" sdlog="sigma(modfit1))-0.1)newdat$Effort" pos.cpue.se="lnorm.se(.data$fit2,sqrt(.data$se.fit2^2+sigma(modfit2)^2))," prob.se="sqrt(.data$se.fit^2+.data$fit*(1-.data$fit)))" sim1="replicate(nsim,rbinom(nObs,1,ilogit(a" sim2="replicate(nsim,newdat$Effortexp(rnorm(nObs,b" size="modfit1$theta))" negative binomial data mu="as.vector(exp(a" phi="modfit1$phi))newdat$Effort" vcov simulatetmbtweediedraw modtype d="match(allpred$matchColumn,obsdatval$matchColumn)" obsdatval stratatotal group_by_at summarize yeartotal group_by stratapred summarize_at rowwise totallci="quantile(c_across(as.character(1:nsim)),p=CIval/2)," totaluci="quantile(c_across(as.character(1:nsim)),p=1-CIval/2))" dplyr::select yearpred max print cv or na variance returnval="NULL" write.csv generate without estimating makepredictionsnovar><meta property="og:description" content="#' Generate standard errors and confidence intervals of predictions from simulation from regression coefficients and their var/covar matrix
#'
#' @param modfit1 Value
#' @param modfit2 Value
#' @param newdat Value
#' @param modtype Value
#' @param obsdatval Value
#' @param includeObsCatch Value
#' @param nsim Value
#' @param requiredVarNames Value
#' @param CIval Value
#' @param printOutput Value
#' @param catchType Value
#' @param common Value
#' @param dirname Value
#' @param run Value
#' @import tidyr
#' @importFrom stats predict model.matrix rbinom sigma rnorm rlnorm rnbinom quantile
#' @importFrom MASS mvrnorm gamma.shape
#' @keywords internal
makePredictionsSimVar&amp;lt;-function(modfit1, modfit2=NULL, modtype, newdat, obsdatval=NULL, includeObsCatch, nsim, requiredVarNames, CIval, printOutput=TRUE, catchType, common, dirname, run) 
#Separate out sample units
if(includeObsCatch)    newdat$Effort=newdat$unsampledEffort/newdat$SampleUnits else
newdat$Effort=newdat$Effort/newdat$SampleUnits
newdat=uncount(newdat,.data$SampleUnits)
nObs=dim(newdat)1
#Get predictions
if(modtype==&quot;Tweedie&quot;)  response1&amp;lt;-data.frame(cplm::predict(modfit1,newdata=newdat,type=&quot;response&quot;,se.fit=TRUE)) else
response1&amp;lt;-data.frame(predict(modfit1,newdata=newdat,type=&quot;response&quot;,se.fit=TRUE))
if(dim(response1)2==1) 
names(response1)=&quot;fit&quot;
if(modtype==&quot;Tweedie&quot;)
response1$se.fit=getSimSE(modfit1, newdat, transFunc=&quot;exp&quot;,offsetval=NULL, nsim=nsim) else
response1$se.fit=rep(NA,dim(response1)2)if(!is.null(modfit2))  
response2&amp;lt;-data.frame(predict(modfit2,newdata=newdat,se.fit=TRUE,type=&quot;response&quot;))
names(response2)=paste0(names(response2),&quot;2&quot;)if(!any(is.na(response1$se.fit)) &amp;amp; !max(response1$se.fit/response1$fit,na.rm=TRUE)&amp;gt;10000)  
#Set up model matrices for simulation
yvar=sub( &quot; &quot;, &quot; &quot;,formula(modfit1) )2
newdat&amp;lt;-cbind(y=rep(1,nObs),newdat)
names(newdat)1=yvar
a=model.matrix(formula(modfit1),data=newdat)
if(!is.null(modfit2)) 
yvar=sub( &quot; &quot;, &quot; &quot;,formula(modfit2) )2
if(! yvar %in% names(newdat)) 
newdat&amp;lt;-cbind(y=rep(1,nObs),newdat)
names(newdat)1=yvarb=model.matrix(formula(modfit2),data=newdat)#Get predictions sim
if(modtype == &quot;Binomial&quot;) 
allpred&amp;lt;-cbind(newdat,response1) %&amp;gt;%
mutate(Total=.data$fit,TotalVar=.data$se.fit^2+.data$fit*(1-.data$fit))
sim=replicate(nsim,rbinom(nObs,1,ilogit(a %% mvrnorm(1,coef(modfit1),vcov(modfit1))) ) )

if(modtype==&quot;Normal&quot;) 
allpred&amp;lt;-cbind(newdat,response1)   %&amp;gt;%
mutate(Total=.data$Effort.data$fit,
TotalVar=.data$Effort^2*(.data$se.fit^2+sigma(.data$modfit1)^2))
sim=replicate(nsim,rnorm(nObs,
mean=as.vector(a %% mvrnorm(1,coef(modfit1),vcov(modfit1))),
sd=sigma(modfit1)))newdat$Effort

if(modtype==&quot;Lognormal&quot;) 
allpred&amp;lt;-cbind(newdat,response1)   %&amp;gt;%
mutate(Total=.data$Effort(lnorm.mean(.data$fit,sqrt(.data$se.fit^2+sigma(modfit1)^2))-0.1),
TotalVar=.data$Effort^2lnorm.se(.data$fit,sqrt(.data$se.fit^2+sigma(modfit1)^2))^2)
sim=replicate(nsim,rlnorm(nObs,
meanlog=as.vector((a %% mvrnorm(1,coef(modfit1),vcov(modfit1)))),
sdlog=sigma(modfit1))-0.1)newdat$Effort

if(modtype==&quot;Gamma&quot;) 
allpred&amp;lt;-cbind(newdat,response1)   %&amp;gt;%
mutate(Total=.data$Effort(.data$fit-0.1),
TotalVar=.data$Effort^2(.data$se.fit^2+.data$fitgamma.shape(modfit1)[1]))
sim=replicate(nsim,newdat$Effort(simulateGammaDraw(modfit1,nObs,a)-0.1) )if(modtype == &quot;Delta-Lognormal&quot;) 
allpred&amp;lt;-cbind(newdat,response1,response2) %&amp;gt;%
mutate(pos.cpue=lnorm.mean(.data$fit2,sqrt(.data$se.fit2^2+sigma(modfit2)^2)),
pos.cpue.se=lnorm.se(.data$fit2,sqrt(.data$se.fit2^2+sigma(modfit2)^2)),
prob.se=sqrt(.data$se.fit^2+.data$fit*(1-.data$fit))) %&amp;gt;%
mutate(Total=.data$Effort*.data$fit*.data$pos.cpue,
TotalVar=.data$Effort^2lo.se(.data$fit,.data$prob.se,.data$pos.cpue,.data$pos.cpue.se)^2)
sim1=replicate(nsim,rbinom(nObs,1,ilogit(a %% mvrnorm(1,coef(modfit1),vcov(modfit1))) ) )
sim2=replicate(nsim,newdat$Effortexp(rnorm(nObs,b %%
mvrnorm(1,coef(modfit2),vcov(modfit2)),sigma(modfit2)) ) )
sim=sim1sim2

if(modtype == &quot;Delta-Gamma&quot;) 
allpred&amp;lt;-cbind(newdat,response1,response2) %&amp;gt;%
mutate(pos.cpue.se=sqrt(.data$se.fit2^2+.data$fit2gamma.shape(modfit2)[1]),
prob.se=sqrt(.data$se.fit^2+.data$fit*(1-.data$fit))) %&amp;gt;%
mutate(Total=.data$Effort*.data$fit*.data$fit2,
TotalVar=.data$Effort^2lo.se(.data$fit,.data$prob.se,.data$fit2,.data$pos.cpue.se)^2)
sim1=replicate(nsim,rbinom(nObs,1,ilogit(a %% mvrnorm(1,coef(modfit1),vcov(modfit1))) ) )
sim2=replicate(nsim,newdat$EffortsimulateGammaDraw(modfit2,nObs,b) )
sim=sim1sim2if(modtype==&quot;NegBin&quot;) 
allpred&amp;lt;-cbind(newdat,response1)   %&amp;gt;%
mutate(Total=.data$fit,TotalVar=.data$se.fit^2+.data$fit+.data$fit^2/modfit1$theta)
sim = replicate(nsim,rnbinom(nObs,mu=exp(a %% mvrnorm(1,coef(modfit1),vcov(modfit1)))newdat$Effort,
size=modfit1$theta))  #Simulate negative binomial data

if(modtype==&quot;Tweedie&quot;) 
allpred=cbind(newdat,response1)   %&amp;gt;%
mutate(Total=.data$Effort.data$fit,
TotalVar=.data$Effort^2(.data$se.fit^2+modfit1$phi*.data$fit^modfit1$p))
sim=replicate(nsim,rtweedie(nObs,power=modfit1$p,
mu=as.vector(exp(a %% mvrnorm(1,coef(modfit1),modfit1$vcov))),
phi=modfit1$phi))newdat$Effort

if(modtype==&quot;TMBnbinom1&quot;) 
allpred&amp;lt;-cbind(newdat,response1)  %&amp;gt;%
mutate(Total=.data$fit,
TotalVar=.data$se.fit^2+.data$fit+.data$fitsigma(modfit1))
sim = replicate(nsim,simulateNegBin1Draw(modfit1,nObs,a,newdat$Effort))

if(modtype==&quot;TMBnbinom2&quot;) 
allpred&amp;lt;-cbind(newdat,response1)  %&amp;gt;%
mutate(Total=.data$fit,
TotalVar=.data$se.fit^2+.data$fit+.data$fit^2/sigma(modfit1))
sim = replicate(nsim,rnbinom(nObs,mu=exp(a %% mvrnorm(1,fixef(modfit1)[1],
vcov(modfit1)[1]))newdat$Effort, size=sigma(modfit1)))

if(modtype==&quot;TMBtweedie&quot;) 
allpred&amp;lt;-cbind(newdat,response1)  %&amp;gt;%
mutate(Total=.data$Effort.data$fit,
TotalVar=.data$Effort^2*(.data$se.fit^2+sigma(modfit1)*.data$fit^(glmmTMB:::.tweedie_power(modfit1))))
sim=replicate(nsim, simulateTMBTweedieDraw(modfit1,nObs,a,newdat$Effort) )if(includeObsCatch &amp;amp; modtype!=&quot;Binomial&quot;) 
d=match(allpred$matchColumn,obsdatval$matchColumn)
allpred$Total!is.na(d)= allpred$Total!is.na(d) + obsdatval$Catch[d!is.na(d)]
sim!is.na(d),= sim!is.na(d), + obsdatval$Catch[d!is.na(d)]if(includeObsCatch &amp;amp; modtype==&quot;Binomial&quot;) 
d=match(allpred$matchColumn,obsdatval$matchColumn)
allpred$Total!is.na(d)= obsdatval$pres[d!is.na(d)]
sim!is.na(d),= obsdatval$presd!is.na(d)stratatotal&amp;lt;-allpred %&amp;gt;%
group_by_at(all_of(requiredVarNames)) %&amp;gt;%
summarize(Total=sum(.data$Total,na.rm=TRUE))
yeartotal&amp;lt;-allpred%&amp;gt;% group_by(.data$Year) %&amp;gt;%
summarize(Total=sum(.data$Total,na.rm=TRUE))
stratapred&amp;lt;-cbind(newdat,sim) %&amp;gt;%
group_by_at(all_of(requiredVarNames)) %&amp;gt;%
summarize_at(.vars=as.character(1:nsim),.funs=sum,na.rm=TRUE) %&amp;gt;%
rowwise() %&amp;gt;%
mutate(Total.mean=mean(c_across(as.character(1:nsim))),
TotalVar=var(c_across(as.character(1:nsim))),
TotalLCI=quantile(c_across(as.character(1:nsim)),p=CIval/2),
TotalUCI=quantile(c_across(as.character(1:nsim)),p=1-CIval/2)) %&amp;gt;%
mutate(TotalLCI=ifelse(.data$TotalLCI&amp;lt;0,0,.data$TotalLCI),Total.mean=ifelse(.data$Total.mean&amp;lt;0,0,.data$Total.mean)) %&amp;gt;%
mutate(Total.se=sqrt(.data$TotalVar))  %&amp;gt;%
mutate(Total.cv=.data$Total.se/.data$Total.mean)  %&amp;gt;%
dplyr::select(-one_of(as.character(1:nsim)))
stratapred$Total=stratatotal$Total
yearpred&amp;lt;-cbind(newdat,sim) %&amp;gt;%
group_by(.data$Year) %&amp;gt;%
summarize_at(.vars=as.character(1:nsim),.funs=sum,na.rm=TRUE) %&amp;gt;%
rowwise() %&amp;gt;%
mutate(Total.mean=mean(c_across(as.character(1:nsim))),
TotalVar=var(c_across(as.character(1:nsim))),
TotalLCI=quantile(c_across(as.character(1:nsim)),p=CIval/2),
TotalUCI=quantile(c_across(as.character(1:nsim)),p=1-CIval/2)) %&amp;gt;%
mutate(TotalLCI=ifelse(.data$TotalLCI&amp;lt;0,0,.data$TotalLCI),Total.mean=ifelse(.data$Total.mean&amp;lt;0,0,.data$Total.mean)) %&amp;gt;%
mutate(Total.se=sqrt(.data$TotalVar))  %&amp;gt;%
mutate(Total.cv=.data$Total.se/.data$Total.mean)  %&amp;gt;%
dplyr::select(-one_of(as.character(1:nsim)))
yearpred$Total&amp;lt;-yeartotal$Total
if(is.na(max(yearpred$Total.cv)) | max(yearpred$Total.cv,na.rm=TRUE)&amp;gt;10) 
print(paste(commonrun,modtype,&quot; CV &amp;gt;10 or NA variance&quot;))
returnval=NULL
  else       returnval=yearpred  
if(printOutput) 
write.csv(stratapred,paste0(dirname[run],commonrun,catchTyperun,modtype,&quot;StratumSummary.csv&quot;))
write.csv(yearpred,paste0(dirname[run],commonrun,catchTyperun,modtype,&quot;AnnualSummary.csv&quot;)) else  
print(paste(commonrun,modtype,&quot; CV &amp;gt;10 or NA variance&quot;))
returnval=NULLreturnval

Generate predictions without estimating variance"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BycatchEstimator</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/UserGuide2.html">Bycatch-Estimator User Guide</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>#' Generate standard errors and confidence intervals of predictions from simulation from regression coefficients and their var/covar matrix
#'
#' @param modfit1 Value
#' @param modfit2 Value
#' @param newdat Value
#' @param modtype Value
#' @param obsdatval Value
#' @param includeObsCatch Value
#' @param nsim Value
#' @param requiredVarNames Value
#' @param CIval Value
#' @param printOutput Value
#' @param catchType Value
#' @param common Value
#' @param dirname Value
#' @param run Value
#' @import tidyr
#' @importFrom stats predict model.matrix rbinom sigma rnorm rlnorm rnbinom quantile
#' @importFrom MASS mvrnorm gamma.shape
#' @keywords internal
makePredictionsSimVar&lt;-function(modfit1, modfit2=NULL, modtype, newdat, obsdatval=NULL, includeObsCatch, nsim, requiredVarNames, CIval, printOutput=TRUE, catchType, common, dirname, run) 
#Separate out sample units
if(includeObsCatch)    newdat$Effort=newdat$unsampledEffort/newdat$SampleUnits else
newdat$Effort=newdat$Effort/newdat$SampleUnits
newdat=uncount(newdat,.data$SampleUnits)
nObs=dim(newdat)1
#Get predictions
if(modtype=="Tweedie")  response1&lt;-data.frame(cplm::predict(modfit1,newdata=newdat,type="response",se.fit=TRUE)) else
response1&lt;-data.frame(predict(modfit1,newdata=newdat,type="response",se.fit=TRUE))
if(dim(response1)2==1) 
names(response1)="fit"
if(modtype=="Tweedie")
response1$se.fit=getSimSE(modfit1, newdat, transFunc="exp",offsetval=NULL, nsim=nsim) else
response1$se.fit=rep(NA,dim(response1)2)

if(!is.null(modfit2))  
response2&lt;-data.frame(predict(modfit2,newdata=newdat,se.fit=TRUE,type="response"))
names(response2)=paste0(names(response2),"2")

if(!any(is.na(response1$se.fit)) &amp; !max(response1$se.fit/response1$fit,na.rm=TRUE)&gt;10000)  
#Set up model matrices for simulation
yvar=sub( " ", " ",formula(modfit1) )2
newdat&lt;-cbind(y=rep(1,nObs),newdat)
names(newdat)1=yvar
a=model.matrix(formula(modfit1),data=newdat)
if(!is.null(modfit2)) 
yvar=sub( " ", " ",formula(modfit2) )2
if(! yvar %in% names(newdat)) 
newdat&lt;-cbind(y=rep(1,nObs),newdat)
names(newdat)1=yvar

b=model.matrix(formula(modfit2),data=newdat)

#Get predictions sim
if(modtype == "Binomial") 
allpred&lt;-cbind(newdat,response1) %&gt;%
mutate(Total=.data$fit,TotalVar=.data$se.fit^2+.data$fit*(1-.data$fit))
sim=replicate(nsim,rbinom(nObs,1,ilogit(a %<em>% mvrnorm(1,coef(modfit1),vcov(modfit1))) ) )
</em>
if(modtype=="Normal") 
allpred&lt;-cbind(newdat,response1)   %&gt;%
mutate(Total=.data$Effort.data$fit,
TotalVar=.data$Effort^2*(.data$se.fit^2+sigma(.data$modfit1)^2))
sim=replicate(nsim,rnorm(nObs,
mean=as.vector(a %<em>% mvrnorm(1,coef(modfit1),vcov(modfit1))),
sd=sigma(modfit1)))<em>newdat$Effort
</em>
if(modtype=="Lognormal") 
allpred&lt;-cbind(newdat,response1)   %&gt;%
mutate(Total=.data$Effort(lnorm.mean(.data$fit,sqrt(.data$se.fit^2+sigma(modfit1)^2))-0.1),
TotalVar=.data$Effort^2</em>lnorm.se(.data$fit,sqrt(.data$se.fit^2+sigma(modfit1)^2))^2)
sim=replicate(nsim,rlnorm(nObs,
meanlog=as.vector((a %<em>% mvrnorm(1,coef(modfit1),vcov(modfit1)))),
sdlog=sigma(modfit1))-0.1)<em>newdat$Effort
</em>
if(modtype=="Gamma") 
allpred&lt;-cbind(newdat,response1)   %&gt;%
mutate(Total=.data$Effort(.data$fit-0.1),
TotalVar=.data$Effort^2</em>(.data$se.fit^2+.data$fit<em>gamma.shape(modfit1)[1]))
sim=replicate(nsim,newdat$Effort</em>(simulateGammaDraw(modfit1,nObs,a)-0.1) )

if(modtype == "Delta-Lognormal") 
allpred&lt;-cbind(newdat,response1,response2) %&gt;%
mutate(pos.cpue=lnorm.mean(.data$fit2,sqrt(.data$se.fit2^2+sigma(modfit2)^2)),
pos.cpue.se=lnorm.se(.data$fit2,sqrt(.data$se.fit2^2+sigma(modfit2)^2)),
prob.se=sqrt(.data$se.fit^2+.data$fit*(1-.data$fit))) %&gt;%
mutate(Total=.data$Effort*.data$fit*.data$pos.cpue,
TotalVar=.data$Effort^2<em>lo.se(.data$fit,.data$prob.se,.data$pos.cpue,.data$pos.cpue.se)^2)
sim1=replicate(nsim,rbinom(nObs,1,ilogit(a %</em>% mvrnorm(1,coef(modfit1),vcov(modfit1))) ) )
sim2=replicate(nsim,newdat$Effort<em>exp(rnorm(nObs,b %</em>%
mvrnorm(1,coef(modfit2),vcov(modfit2)),sigma(modfit2)) ) )
sim=sim1<em>sim2
</em>
if(modtype == "Delta-Gamma") 
allpred&lt;-cbind(newdat,response1,response2) %&gt;%
mutate(pos.cpue.se=sqrt(.data$se.fit2^2+.data$fit2gamma.shape(modfit2)[1]),
prob.se=sqrt(.data$se.fit^2+.data$fit*(1-.data$fit))) %&gt;%
mutate(Total=.data$Effort*.data$fit*.data$fit2,
TotalVar=.data$Effort^2<em>lo.se(.data$fit,.data$prob.se,.data$fit2,.data$pos.cpue.se)^2)
sim1=replicate(nsim,rbinom(nObs,1,ilogit(a %</em>% mvrnorm(1,coef(modfit1),vcov(modfit1))) ) )
sim2=replicate(nsim,newdat$Effort<em>simulateGammaDraw(modfit2,nObs,b) )
sim=sim1</em>sim2

if(modtype=="NegBin") 
allpred&lt;-cbind(newdat,response1)   %&gt;%
mutate(Total=.data$fit,TotalVar=.data$se.fit^2+.data$fit+.data$fit^2/modfit1$theta)
sim = replicate(nsim,rnbinom(nObs,mu=exp(a %<em>% mvrnorm(1,coef(modfit1),vcov(modfit1)))<em>newdat$Effort,
size=modfit1$theta))  #Simulate negative binomial data
</em>
if(modtype=="Tweedie") 
allpred=cbind(newdat,response1)   %&gt;%
mutate(Total=.data$Effort.data$fit,
TotalVar=.data$Effort^2</em>(.data$se.fit^2+modfit1$phi*.data$fit^modfit1$p))
sim=replicate(nsim,rtweedie(nObs,power=modfit1$p,
mu=as.vector(exp(a %<em>% mvrnorm(1,coef(modfit1),modfit1$vcov))),
phi=modfit1$phi))<em>newdat$Effort
</em>
if(modtype=="TMBnbinom1") 
allpred&lt;-cbind(newdat,response1)  %&gt;%
mutate(Total=.data$fit,
TotalVar=.data$se.fit^2+.data$fit+.data$fitsigma(modfit1))
sim = replicate(nsim,simulateNegBin1Draw(modfit1,nObs,a,newdat$Effort))
</em>
if(modtype=="TMBnbinom2") 
allpred&lt;-cbind(newdat,response1)  %&gt;%
mutate(Total=.data$fit,
TotalVar=.data$se.fit^2+.data$fit+.data$fit^2/sigma(modfit1))
sim = replicate(nsim,rnbinom(nObs,mu=exp(a %% mvrnorm(1,fixef(modfit1)[1],
vcov(modfit1)[1]))<em>newdat$Effort, size=sigma(modfit1)))
</em>
if(modtype=="TMBtweedie") 
allpred&lt;-cbind(newdat,response1)  %&gt;%
mutate(Total=.data$Effort.data$fit,
TotalVar=.data$Effort^2*(.data$se.fit^2+sigma(modfit1)*.data$fit^(glmmTMB:::.tweedie_power(modfit1))))
sim=replicate(nsim, simulateTMBTweedieDraw(modfit1,nObs,a,newdat$Effort) )

if(includeObsCatch &amp; modtype!="Binomial") 
d=match(allpred$matchColumn,obsdatval$matchColumn)
allpred$Total!is.na(d)= allpred$Total!is.na(d) + obsdatval$Catch[d!is.na(d)]
sim!is.na(d),= sim!is.na(d), + obsdatval$Catch[d!is.na(d)]

if(includeObsCatch &amp; modtype=="Binomial") 
d=match(allpred$matchColumn,obsdatval$matchColumn)
allpred$Total!is.na(d)= obsdatval$pres[d!is.na(d)]
sim!is.na(d),= obsdatval$presd!is.na(d)

stratatotal&lt;-allpred %&gt;%
group_by_at(all_of(requiredVarNames)) %&gt;%
summarize(Total=sum(.data$Total,na.rm=TRUE))
yeartotal&lt;-allpred%&gt;% group_by(.data$Year) %&gt;%
summarize(Total=sum(.data$Total,na.rm=TRUE))
stratapred&lt;-cbind(newdat,sim) %&gt;%
group_by_at(all_of(requiredVarNames)) %&gt;%
summarize_at(.vars=as.character(1:nsim),.funs=sum,na.rm=TRUE) %&gt;%
rowwise() %&gt;%
mutate(Total.mean=mean(c_across(as.character(1:nsim))),
TotalVar=var(c_across(as.character(1:nsim))),
TotalLCI=quantile(c_across(as.character(1:nsim)),p=CIval/2),
TotalUCI=quantile(c_across(as.character(1:nsim)),p=1-CIval/2)) %&gt;%
mutate(TotalLCI=ifelse(.data$TotalLCI&lt;0,0,.data$TotalLCI),Total.mean=ifelse(.data$Total.mean&lt;0,0,.data$Total.mean)) %&gt;%
mutate(Total.se=sqrt(.data$TotalVar))  %&gt;%
mutate(Total.cv=.data$Total.se/.data$Total.mean)  %&gt;%
dplyr::select(-one_of(as.character(1:nsim)))
stratapred$Total=stratatotal$Total
yearpred&lt;-cbind(newdat,sim) %&gt;%
group_by(.data$Year) %&gt;%
summarize_at(.vars=as.character(1:nsim),.funs=sum,na.rm=TRUE) %&gt;%
rowwise() %&gt;%
mutate(Total.mean=mean(c_across(as.character(1:nsim))),
TotalVar=var(c_across(as.character(1:nsim))),
TotalLCI=quantile(c_across(as.character(1:nsim)),p=CIval/2),
TotalUCI=quantile(c_across(as.character(1:nsim)),p=1-CIval/2)) %&gt;%
mutate(TotalLCI=ifelse(.data$TotalLCI&lt;0,0,.data$TotalLCI),Total.mean=ifelse(.data$Total.mean&lt;0,0,.data$Total.mean)) %&gt;%
mutate(Total.se=sqrt(.data$TotalVar))  %&gt;%
mutate(Total.cv=.data$Total.se/.data$Total.mean)  %&gt;%
dplyr::select(-one_of(as.character(1:nsim)))
yearpred$Total&lt;-yeartotal$Total
if(is.na(max(yearpred$Total.cv)) | max(yearpred$Total.cv,na.rm=TRUE)&gt;10) 
print(paste(commonrun,modtype," CV &gt;10 or NA variance"))
returnval=NULL
  else       returnval=yearpred  
if(printOutput) 
write.csv(stratapred,paste0(dirname[run],commonrun,catchTyperun,modtype,"StratumSummary.csv"))
write.csv(yearpred,paste0(dirname[run],commonrun,catchTyperun,modtype,"AnnualSummary.csv"))

 else  
print(paste(commonrun,modtype," CV &gt;10 or NA variance"))
returnval=NULL

returnval

Generate predictions without estimating variance</h1>
      
      <div class="d-none name"><code>makePredictionsNoVar.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>#' Generate standard errors and confidence intervals of predictions from simulation from regression coefficients and their var/covar matrix
#'
#' @param modfit1 Value
#' @param modfit2 Value
#' @param newdat Value
#' @param modtype Value
#' @param obsdatval Value
#' @param includeObsCatch Value
#' @param nsim Value
#' @param requiredVarNames Value
#' @param CIval Value
#' @param printOutput Value
#' @param catchType Value
#' @param common Value
#' @param dirname Value
#' @param run Value
#' @import tidyr
#' @importFrom stats predict model.matrix rbinom sigma rnorm rlnorm rnbinom quantile
#' @importFrom MASS mvrnorm gamma.shape
#' @keywords internal
makePredictionsSimVar&lt;-function(modfit1, modfit2=NULL, modtype, newdat, obsdatval=NULL, includeObsCatch, nsim, requiredVarNames, CIval, printOutput=TRUE, catchType, common, dirname, run) 
#Separate out sample units
if(includeObsCatch)    newdat$Effort=newdat$unsampledEffort/newdat$SampleUnits else
newdat$Effort=newdat$Effort/newdat$SampleUnits
newdat=uncount(newdat,.data$SampleUnits)
nObs=dim(newdat)1
#Get predictions
if(modtype=="Tweedie")  response1&lt;-data.frame(cplm::predict(modfit1,newdata=newdat,type="response",se.fit=TRUE)) else
response1&lt;-data.frame(predict(modfit1,newdata=newdat,type="response",se.fit=TRUE))
if(dim(response1)2==1) 
names(response1)="fit"
if(modtype=="Tweedie")
response1$se.fit=getSimSE(modfit1, newdat, transFunc="exp",offsetval=NULL, nsim=nsim) else
response1$se.fit=rep(NA,dim(response1)2)if(!is.null(modfit2))  
response2&lt;-data.frame(predict(modfit2,newdata=newdat,se.fit=TRUE,type="response"))
names(response2)=paste0(names(response2),"2")if(!any(is.na(response1$se.fit)) &amp; !max(response1$se.fit/response1$fit,na.rm=TRUE)&gt;10000)  
#Set up model matrices for simulation
yvar=sub( " ", " ",formula(modfit1) )2
newdat&lt;-cbind(y=rep(1,nObs),newdat)
names(newdat)1=yvar
a=model.matrix(formula(modfit1),data=newdat)
if(!is.null(modfit2)) 
yvar=sub( " ", " ",formula(modfit2) )2
if(! yvar %in% names(newdat)) 
newdat&lt;-cbind(y=rep(1,nObs),newdat)
names(newdat)1=yvarb=model.matrix(formula(modfit2),data=newdat)#Get predictions sim
if(modtype == "Binomial") 
allpred&lt;-cbind(newdat,response1) %&gt;%
mutate(Total=.data$fit,TotalVar=.data$se.fit^2+.data$fit*(1-.data$fit))
sim=replicate(nsim,rbinom(nObs,1,ilogit(a %<em>% mvrnorm(1,coef(modfit1),vcov(modfit1))) ) )
</em>
if(modtype=="Normal") 
allpred&lt;-cbind(newdat,response1)   %&gt;%
mutate(Total=.data$Effort.data$fit,
TotalVar=.data$Effort^2*(.data$se.fit^2+sigma(.data$modfit1)^2))
sim=replicate(nsim,rnorm(nObs,
mean=as.vector(a %<em>% mvrnorm(1,coef(modfit1),vcov(modfit1))),
sd=sigma(modfit1)))<em>newdat$Effort
</em>
if(modtype=="Lognormal") 
allpred&lt;-cbind(newdat,response1)   %&gt;%
mutate(Total=.data$Effort(lnorm.mean(.data$fit,sqrt(.data$se.fit^2+sigma(modfit1)^2))-0.1),
TotalVar=.data$Effort^2</em>lnorm.se(.data$fit,sqrt(.data$se.fit^2+sigma(modfit1)^2))^2)
sim=replicate(nsim,rlnorm(nObs,
meanlog=as.vector((a %<em>% mvrnorm(1,coef(modfit1),vcov(modfit1)))),
sdlog=sigma(modfit1))-0.1)<em>newdat$Effort
</em>
if(modtype=="Gamma") 
allpred&lt;-cbind(newdat,response1)   %&gt;%
mutate(Total=.data$Effort(.data$fit-0.1),
TotalVar=.data$Effort^2</em>(.data$se.fit^2+.data$fit<em>gamma.shape(modfit1)[1]))
sim=replicate(nsim,newdat$Effort</em>(simulateGammaDraw(modfit1,nObs,a)-0.1) )if(modtype == "Delta-Lognormal") 
allpred&lt;-cbind(newdat,response1,response2) %&gt;%
mutate(pos.cpue=lnorm.mean(.data$fit2,sqrt(.data$se.fit2^2+sigma(modfit2)^2)),
pos.cpue.se=lnorm.se(.data$fit2,sqrt(.data$se.fit2^2+sigma(modfit2)^2)),
prob.se=sqrt(.data$se.fit^2+.data$fit*(1-.data$fit))) %&gt;%
mutate(Total=.data$Effort*.data$fit*.data$pos.cpue,
TotalVar=.data$Effort^2<em>lo.se(.data$fit,.data$prob.se,.data$pos.cpue,.data$pos.cpue.se)^2)
sim1=replicate(nsim,rbinom(nObs,1,ilogit(a %</em>% mvrnorm(1,coef(modfit1),vcov(modfit1))) ) )
sim2=replicate(nsim,newdat$Effort<em>exp(rnorm(nObs,b %</em>%
mvrnorm(1,coef(modfit2),vcov(modfit2)),sigma(modfit2)) ) )
sim=sim1<em>sim2
</em>
if(modtype == "Delta-Gamma") 
allpred&lt;-cbind(newdat,response1,response2) %&gt;%
mutate(pos.cpue.se=sqrt(.data$se.fit2^2+.data$fit2gamma.shape(modfit2)[1]),
prob.se=sqrt(.data$se.fit^2+.data$fit*(1-.data$fit))) %&gt;%
mutate(Total=.data$Effort*.data$fit*.data$fit2,
TotalVar=.data$Effort^2<em>lo.se(.data$fit,.data$prob.se,.data$fit2,.data$pos.cpue.se)^2)
sim1=replicate(nsim,rbinom(nObs,1,ilogit(a %</em>% mvrnorm(1,coef(modfit1),vcov(modfit1))) ) )
sim2=replicate(nsim,newdat$Effort<em>simulateGammaDraw(modfit2,nObs,b) )
sim=sim1</em>sim2if(modtype=="NegBin") 
allpred&lt;-cbind(newdat,response1)   %&gt;%
mutate(Total=.data$fit,TotalVar=.data$se.fit^2+.data$fit+.data$fit^2/modfit1$theta)
sim = replicate(nsim,rnbinom(nObs,mu=exp(a %<em>% mvrnorm(1,coef(modfit1),vcov(modfit1)))<em>newdat$Effort,
size=modfit1$theta))  #Simulate negative binomial data
</em>
if(modtype=="Tweedie") 
allpred=cbind(newdat,response1)   %&gt;%
mutate(Total=.data$Effort.data$fit,
TotalVar=.data$Effort^2</em>(.data$se.fit^2+modfit1$phi*.data$fit^modfit1$p))
sim=replicate(nsim,rtweedie(nObs,power=modfit1$p,
mu=as.vector(exp(a %<em>% mvrnorm(1,coef(modfit1),modfit1$vcov))),
phi=modfit1$phi))<em>newdat$Effort
</em>
if(modtype=="TMBnbinom1") 
allpred&lt;-cbind(newdat,response1)  %&gt;%
mutate(Total=.data$fit,
TotalVar=.data$se.fit^2+.data$fit+.data$fitsigma(modfit1))
sim = replicate(nsim,simulateNegBin1Draw(modfit1,nObs,a,newdat$Effort))
</em>
if(modtype=="TMBnbinom2") 
allpred&lt;-cbind(newdat,response1)  %&gt;%
mutate(Total=.data$fit,
TotalVar=.data$se.fit^2+.data$fit+.data$fit^2/sigma(modfit1))
sim = replicate(nsim,rnbinom(nObs,mu=exp(a %% mvrnorm(1,fixef(modfit1)[1],
vcov(modfit1)[1]))<em>newdat$Effort, size=sigma(modfit1)))
</em>
if(modtype=="TMBtweedie") 
allpred&lt;-cbind(newdat,response1)  %&gt;%
mutate(Total=.data$Effort.data$fit,
TotalVar=.data$Effort^2*(.data$se.fit^2+sigma(modfit1)*.data$fit^(glmmTMB:::.tweedie_power(modfit1))))
sim=replicate(nsim, simulateTMBTweedieDraw(modfit1,nObs,a,newdat$Effort) )if(includeObsCatch &amp; modtype!="Binomial") 
d=match(allpred$matchColumn,obsdatval$matchColumn)
allpred$Total!is.na(d)= allpred$Total!is.na(d) + obsdatval$Catch[d!is.na(d)]
sim!is.na(d),= sim!is.na(d), + obsdatval$Catch[d!is.na(d)]if(includeObsCatch &amp; modtype=="Binomial") 
d=match(allpred$matchColumn,obsdatval$matchColumn)
allpred$Total!is.na(d)= obsdatval$pres[d!is.na(d)]
sim!is.na(d),= obsdatval$presd!is.na(d)stratatotal&lt;-allpred %&gt;%
group_by_at(all_of(requiredVarNames)) %&gt;%
summarize(Total=sum(.data$Total,na.rm=TRUE))
yeartotal&lt;-allpred%&gt;% group_by(.data$Year) %&gt;%
summarize(Total=sum(.data$Total,na.rm=TRUE))
stratapred&lt;-cbind(newdat,sim) %&gt;%
group_by_at(all_of(requiredVarNames)) %&gt;%
summarize_at(.vars=as.character(1:nsim),.funs=sum,na.rm=TRUE) %&gt;%
rowwise() %&gt;%
mutate(Total.mean=mean(c_across(as.character(1:nsim))),
TotalVar=var(c_across(as.character(1:nsim))),
TotalLCI=quantile(c_across(as.character(1:nsim)),p=CIval/2),
TotalUCI=quantile(c_across(as.character(1:nsim)),p=1-CIval/2)) %&gt;%
mutate(TotalLCI=ifelse(.data$TotalLCI&lt;0,0,.data$TotalLCI),Total.mean=ifelse(.data$Total.mean&lt;0,0,.data$Total.mean)) %&gt;%
mutate(Total.se=sqrt(.data$TotalVar))  %&gt;%
mutate(Total.cv=.data$Total.se/.data$Total.mean)  %&gt;%
dplyr::select(-one_of(as.character(1:nsim)))
stratapred$Total=stratatotal$Total
yearpred&lt;-cbind(newdat,sim) %&gt;%
group_by(.data$Year) %&gt;%
summarize_at(.vars=as.character(1:nsim),.funs=sum,na.rm=TRUE) %&gt;%
rowwise() %&gt;%
mutate(Total.mean=mean(c_across(as.character(1:nsim))),
TotalVar=var(c_across(as.character(1:nsim))),
TotalLCI=quantile(c_across(as.character(1:nsim)),p=CIval/2),
TotalUCI=quantile(c_across(as.character(1:nsim)),p=1-CIval/2)) %&gt;%
mutate(TotalLCI=ifelse(.data$TotalLCI&lt;0,0,.data$TotalLCI),Total.mean=ifelse(.data$Total.mean&lt;0,0,.data$Total.mean)) %&gt;%
mutate(Total.se=sqrt(.data$TotalVar))  %&gt;%
mutate(Total.cv=.data$Total.se/.data$Total.mean)  %&gt;%
dplyr::select(-one_of(as.character(1:nsim)))
yearpred$Total&lt;-yeartotal$Total
if(is.na(max(yearpred$Total.cv)) | max(yearpred$Total.cv,na.rm=TRUE)&gt;10) 
print(paste(commonrun,modtype," CV &gt;10 or NA variance"))
returnval=NULL
  else       returnval=yearpred  
if(printOutput) 
write.csv(stratapred,paste0(dirname[run],commonrun,catchTyperun,modtype,"StratumSummary.csv"))
write.csv(yearpred,paste0(dirname[run],commonrun,catchTyperun,modtype,"AnnualSummary.csv")) else  
print(paste(commonrun,modtype," CV &gt;10 or NA variance"))
returnval=NULLreturnval

Generate predictions without estimating variance</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">makePredictionsNoVar</span><span class="op">(</span></span>
<span>  <span class="va">modfit1</span>,</span>
<span>  modfit2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">modtype</span>,</span>
<span>  <span class="va">newdat</span>,</span>
<span>  obsdatval <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">nsims</span>,</span>
<span>  <span class="va">includeObsCatch</span>,</span>
<span>  <span class="va">requiredVarNames</span>,</span>
<span>  printOutput <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">catchType</span>,</span>
<span>  <span class="va">common</span>,</span>
<span>  <span class="va">dirname</span>,</span>
<span>  <span class="va">run</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>modfit1</dt>
<dd><p>Value</p></dd>


<dt>modfit2</dt>
<dd><p>Value</p></dd>


<dt>modtype</dt>
<dd><p>Value</p></dd>


<dt>newdat</dt>
<dd><p>Value</p></dd>


<dt>obsdatval</dt>
<dd><p>Value</p></dd>


<dt>includeObsCatch</dt>
<dd><p>Value</p></dd>


<dt>requiredVarNames</dt>
<dd><p>Value</p></dd>


<dt>printOutput</dt>
<dd><p>Value</p></dd>


<dt>catchType</dt>
<dd><p>Value</p></dd>


<dt>common</dt>
<dd><p>Value</p></dd>


<dt>dirname</dt>
<dd><p>Value</p></dd>


<dt>run</dt>
<dd><p>Value</p></dd>


<dt>CIval</dt>
<dd><p>Value</p></dd>

</dl></div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Elizabeth Babcock.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

